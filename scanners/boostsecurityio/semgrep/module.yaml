api_version: 1.0

id: boostsecurityio/semgrep
name: Semgrep
namespace: boostsecurityio/semgrep
scan_types:
  - sast

config:
  support_diff_scan: true
  include_files:
  - .semgrep/*

setup:
  - name: Validate rules
    environment:
      SEMGREP_RULES: ${SEMGREP_RULES:-https://assets.build.boostsecurity.io/semgrep-rules/stable/all-sast-rules.yml}
    run: |
      echo "CREATING NEW SLN"
      dotnet new sln -n temp
      echo "MERGING SLN"
      find . -name "*.csproj" -exec dotnet sln temp.sln add {} \;
      echo "INSTALLING TOOL"
      dotnet tool install CycloneDX --tool-path ./.dotnet-tools
      echo "RUNNING TOOL"
      ./.dotnet-tools/dotnet-CycloneDX $(pwd)/temp.sln --output temp_sbom.json --output-format json
      cat temp_sbom.json/bom.json

