api_version: 1.0

id: boostsecurityio/trivy-sbom
name: Trivy (FS SBOM)
namespace: boostsecurityio/trivy-sbom
scan_types:
  - sbom

config:
  support_diff_scan: false

setup:
  - name: Verify dotnet installed
    run: |
      if ! dotnet --version >/dev/null 2>&1; then
      then
        echo "dotnet is not installed, the scanner cannot run."
        exit 1
      fi

steps:
  - scan:
      command:
        run: |
          dotnet new sln -n temp > /dev/null 2>&1
          find . -name "*.csproj" -exec dotnet sln temp.sln add {} \; > /dev/null 2>&1
          dotnet tool install CycloneDX --tool-path ./.dotnet-tools > /dev/null 2>&1
          ./.dotnet-tools/dotnet-CycloneDX $(pwd)/temp.sln --output temp_sbom.json --output-format json > /dev/null 2>&1
          cat temp_sbom.json/bom.json
      format: cyclonedx

