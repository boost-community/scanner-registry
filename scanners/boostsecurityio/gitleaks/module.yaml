api_version: 1.0

id: boostsecurityio/gitleaks
name: BoostSecurity Gitleaks
namespace: boostsecurityio/gitleaks

config:
  support_diff_scan: true

steps:
  - scan:
      format: sarif
      command:
        docker:
          image: zricethezav/gitleaks:v8.16.4@sha256:3ddf2d050a6105f2efb4d5763d8df39c7c32dc8e7b040601999f85e7fc4084fe
          command: detect --no-banner --exit-code 0 --redact --report-format sarif --report-path /dev/stdout --no-git --source .
          workdir: /src
          environment:
            GITLEAKS_CONFIG: ${GITLEAKS_CONFIG:-}

      post-processor:
        docker:
          command: process
          image: public.ecr.aws/boostsecurityio/boost-scanner-gitleaks:da88408@sha256:600b811608386641ab622c25cc9df76b3d69bc1cfe845d5061a2e55247304c36
